class Album{static URL="https://jsonplaceholder.typicode.com/photos?albumId=";static request(t="",e="GET",s){return fetch(Album.URL+t,{method:e,body:s?JSON.stringify(s):void 0,headers:{"Content-type":"application/json"}}).catch(t=>{throw new Error(""+t.message)})}static getImgByAlbumID(t){return Album.request(t).then(t=>{if(t.ok)return t.json();throw new Error("Can't get images.")})}}class Albums{static URL="https://jsonplaceholder.typicode.com/albums";static request(t="",e="GET",s){return fetch(Albums.URL+t,{method:e,body:s?JSON.stringify(s):void 0,headers:{"Content-type":"application/json"}}).catch(t=>{throw new Error(""+t.message)})}static getList(){return Albums.request().then(t=>{if(t.ok)return t.json();throw new Error("Can't get the list of albums.")})}}class LinksCollection{#list;fetch(){return Albums.getList().then(t=>{this.setList(t)})}setList(t){this.#list=t}getList(){return this.#list}getFirstId(){return this.#list[0].id}}class AlbumsCollection{#collection=[];fetch(t){return Album.getImgByAlbumID(t).then(t=>{this.setList(t)})}setList(t){this.#collection=t}getList(){return this.#collection}}class LinksView{static ALBUMS_LIST_SELECTOR="#linksList";static ALBUMS_ITEM_SELECTOR=".links_container__item";#$list;#options;constructor(t){this.#$list=$(LinksView.ALBUMS_LIST_SELECTOR).on("click",LinksView.ALBUMS_ITEM_SELECTOR,t=>this.onAlbumsListClick(t)),this.#options=t}onAlbumsListClick(t){t.preventDefault();t=this.getAlbumId(t.target);this.#options.onSelect(t)}renderAlbumsList(t){t=t.map(t=>this.generateHtmlLinks(t)).join("");this.#$list.html(t)}appendTo(t){t.append(this.#$list)}getAlbumId(t){return t.closest(LinksView.ALBUMS_ITEM_SELECTOR)?.dataset.id}generateHtmlLinks(t){return` 
        <li class="links_container__item" data-id="${t.id}">
            <a class="links_container__link" href="https://jsonplaceholder.typicode.com/photos?albumId=${t.userId}">${t.title}</a>
        </li>
    `}}class AlbumsView{static IMAGES_CONTAINER_SELECTOR="#imgContainer";#$gallery;constructor(){this.#$gallery=$(AlbumsView.IMAGES_CONTAINER_SELECTOR)}appendTo(t){t.append(this.#$gallery)}renderImgList(t){this.#$gallery.innerHTML="";t=t.map(t=>this.generateImages(t)).join("");this.#$gallery.html(t)}generateImages(t){return`
    <li class="img_container__item">
        <img src="${t.url}" alt="${t.id}">
    </li>
    `}}class LinksController{#$rootContainer;#albumsController;constructor(t,e){this.#$rootContainer=t,this.#albumsController=e,this.collection=new LinksCollection,this.linksView=new LinksView({onSelect:t=>e.loadAlbumById(t)}),this.linksView.appendTo(this.#$rootContainer),this.collection.fetch().then(()=>this.renderList()).then(()=>this.loadFirstAlbum())}renderList(){this.linksView.renderAlbumsList(this.collection.getList())}loadFirstAlbum(){var t=this.collection.getFirstId();this.#albumsController.loadAlbumById(t)}}class AlbumsController{#$rootAlbumContainer;constructor(t){this.#$rootAlbumContainer=t,this.collection=new AlbumsCollection,this.albumView=new AlbumsView,this.albumView.appendTo(this.#$rootAlbumContainer)}renderList(){this.albumView.renderImgList(this.collection.getList())}loadAlbumById(t){this.collection.fetch(t).then(()=>this.renderList())}}const albumsController=new AlbumsController($("#imgContainer"));new LinksController($("#linksList"),albumsController);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkFsYnVtLmpzIiwiQWxidW1zLmpzIiwiTGlua3NDb2xsZWN0aW9uLmpzIiwiQWxidW1zQ29sbGVjdGlvbi5qcyIsIkxpbmtzVmlldy5qcyIsIkFsYnVtc1ZpZXcuanMiLCJMaW5rc0NvbnRyb2xsZXIuanMiLCJBbGJ1bXNDb250cm9sbGVyLmpzIl0sIm5hbWVzIjpbIkFsYnVtIiwiVVJMIiwicmVxdWVzdCIsInVybCIsIm1ldGhvZCIsImJvZHkiLCJmZXRjaCIsIkpTT04iLCJzdHJpbmdpZnkiLCJ1bmRlZmluZWQiLCJoZWFkZXJzIiwiQ29udGVudC10eXBlIiwiY2F0Y2giLCJFcnJvciIsImUiLCJtZXNzYWdlIiwiZ2V0SW1nQnlBbGJ1bUlEIiwiaWQiLCJ0aGVuIiwicmVzIiwib2siLCJqc29uIiwiQWxidW1zIiwiZ2V0TGlzdCIsIkxpbmtzQ29sbGVjdGlvbiIsIiNsaXN0IiwidGhpcyIsInNldExpc3QiLCJsaXN0IiwiZ2V0Rmlyc3RJZCIsIkFsYnVtc0NvbGxlY3Rpb24iLCIjY29sbGVjdGlvbiIsImNvbGxlY3Rpb24iLCJMaW5rc1ZpZXciLCJBTEJVTVNfTElTVF9TRUxFQ1RPUiIsIkFMQlVNU19JVEVNX1NFTEVDVE9SIiwiIyRsaXN0IiwiI29wdGlvbnMiLCJjb25zdHJ1Y3RvciIsIm9wdGlvbnMiLCIkIiwib24iLCJvbkFsYnVtc0xpc3RDbGljayIsInByZXZlbnREZWZhdWx0IiwiZ2V0QWxidW1JZCIsInRhcmdldCIsIm9uU2VsZWN0IiwicmVuZGVyQWxidW1zTGlzdCIsImh0bWwiLCJtYXAiLCJnZW5lcmF0ZUh0bWxMaW5rcyIsImpvaW4iLCJhcHBlbmRUbyIsIiRlbCIsImFwcGVuZCIsImVsIiwiY2xvc2VzdCIsImRhdGFzZXQiLCJsaW5rIiwidXNlcklkIiwidGl0bGUiLCJBbGJ1bXNWaWV3IiwiSU1BR0VTX0NPTlRBSU5FUl9TRUxFQ1RPUiIsIiMkZ2FsbGVyeSIsInJlbmRlckltZ0xpc3QiLCJnYWxsZXJ5IiwiaW5uZXJIVE1MIiwiZ2VuZXJhdGVJbWFnZXMiLCJpbWciLCJMaW5rc0NvbnRyb2xsZXIiLCIjJHJvb3RDb250YWluZXIiLCIjYWxidW1zQ29udHJvbGxlciIsIiRjb250YWluZXIiLCJhbGJ1bXNDb250cm9sbGVyIiwibGlua3NWaWV3IiwibG9hZEFsYnVtQnlJZCIsInJlbmRlckxpc3QiLCJsb2FkRmlyc3RBbGJ1bSIsImZpcnN0QWxidW1JZCIsIkFsYnVtc0NvbnRyb2xsZXIiLCIjJHJvb3RBbGJ1bUNvbnRhaW5lciIsImFsYnVtQ29udGFpbmVyIiwiYWxidW1WaWV3Il0sIm1hcHBpbmdzIjoiTUFBQUEsTUFFQUMsV0FBQSx1REFFQUMsZUFBQUMsRUFBQSxHQUFBQyxFQUFBLE1BQUFDLEdBQ0EsT0FBQUMsTUFBQU4sTUFBQUMsSUFBQUUsRUFBQSxDQUNBQyxPQUFBQSxFQUNBQyxLQUFBQSxFQUFBRSxLQUFBQyxVQUFBSCxDQUFBLEVBQUFJLEtBQUFBLEVBQ0FDLFFBQUEsQ0FDQUMsZUFBQSxrQkFDQSxDQUNBLENBQUEsRUFDQUMsTUFBQSxJQUNBLE1BQUEsSUFBQUMsTUFBQSxHQUFBQyxFQUFBQyxPQUFBLENBQ0EsQ0FBQSxDQUNBLENBRUFDLHVCQUFBQyxHQUNBLE9BQUFqQixNQUNBRSxRQUFBZSxDQUFBLEVBQ0FDLEtBQUFDLElBQ0EsR0FBQUEsRUFBQUMsR0FDQSxPQUFBRCxFQUFBRSxLQUFBLEVBRUEsTUFBQSxJQUFBUixNQUFBLG1CQUFBLENBQ0EsQ0FBQSxDQUNBLENBQ0EsT0MzQkFTLE9BRUFyQixXQUFBLDhDQUVBQyxlQUFBQyxFQUFBLEdBQUFDLEVBQUEsTUFBQUMsR0FDQSxPQUFBQyxNQUFBZ0IsT0FBQXJCLElBQUFFLEVBQUEsQ0FDQUMsT0FBQUEsRUFDQUMsS0FBQUEsRUFBQUUsS0FBQUMsVUFBQUgsQ0FBQSxFQUFBSSxLQUFBQSxFQUNBQyxRQUFBLENBQ0FDLGVBQUEsa0JBQ0EsQ0FDQSxDQUFBLEVBQ0FDLE1BQUEsSUFDQSxNQUFBLElBQUFDLE1BQUEsR0FBQUMsRUFBQUMsT0FBQSxDQUNBLENBQUEsQ0FD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V0FBQVQsUUFBQSxDQUFBLENBQ0EsQ0FFQXNELGlCQUNBLElBQUFDLEVBQUFwRCxLQUFBTSxXQUFBSCxXQUFBLEVBQ0FILEtBQUE2QyxrQkFBQUksY0FBQUcsQ0FBQSxDQUNBLENBQ0EsT0MxQkFDLGlCQUNBQyxxQkFFQTFDLFlBQUEyQyxHQUNBdkQsS0FBQXNELHFCQUFBQyxFQUNBdkQsS0FBQU0sV0FBQSxJQUFBRixpQkFDQUosS0FBQXdELFVBQUEsSUFBQXJCLFdBRUFuQyxLQUFBd0QsVUFBQTlCLFNBQUExQixLQUFBc0Qsb0JBQUEsQ0FDQSxDQUVBSixhQUNBbEQsS0FBQXdELFVBQUFsQixjQUFBdEMsS0FBQU0sV0FBQVQsUUFBQSxDQUFBLENBQ0EsQ0FFQW9ELGNBQUExRCxHQUNBUyxLQUFBTSxXQUFBMUIsTUFBQVcsQ0FBQSxFQUFBQyxLQUFBLElBQUFRLEtBQUFrRCxXQUFBLENBQUEsQ0FDQSxDQUNBLENQbEJBLE1BQUFILGlCQUFBLElBQUFNLGlCQUFBdkMsRUFBQSxlQUFBLENBQUEsRUFDQSxJQUFBNkIsZ0JBQUE3QixFQUFBLFlBQUEsRUFBQWlDLGdCQUFBIiwiZmlsZSI6ImFwcC5qcyIsInNvdXJjZXNDb250ZW50IjpbImNsYXNzIEFsYnVtIHtcblxuICAgIHN0YXRpYyBVUkwgPSAnaHR0cHM6Ly9qc29ucGxhY2Vob2xkZXIudHlwaWNvZGUuY29tL3Bob3Rvcz9hbGJ1bUlkPSc7XG5cbiAgICBzdGF0aWMgcmVxdWVzdCh1cmwgPSAnJywgbWV0aG9kID0gJ0dFVCcsIGJvZHkpIHtcbiAgICAgICAgcmV0dXJuIGZldGNoKEFsYnVtLlVSTCArIHVybCwge1xuICAgICAgICAgICAgbWV0aG9kLFxuICAgICAgICAgICAgYm9keTogYm9keSA/IEpTT04uc3RyaW5naWZ5KGJvZHkpIDogdW5kZWZpbmVkLFxuICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgICdDb250ZW50LXR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICAgICB9LFxuICAgICAgICB9KVxuICAgICAgICAgICAgLmNhdGNoKChlKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGAke2UubWVzc2FnZX1gKTtcbiAgICAgICAgICAgIH0pO1xuICAgIH1cblxuICAgIHN0YXRpYyBnZXRJbWdCeUFsYnVtSUQoaWQpIHtcbiAgICAgICAgcmV0dXJuIEFsYnVtXG4gICAgICAgICAgICAucmVxdWVzdChpZClcbiAgICAgICAgICAgIC50aGVuKHJlcyA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKHJlcy5vaykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQ2FuJ3QgZ2V0IGltYWdlcy5cIik7XG4gICAgICAgICAgICB9KTtcbiAgICB9XG59IiwiY2xhc3MgQWxidW1ze1xuXG4gICAgc3RhdGljIFVSTCA9ICdodHRwczovL2pzb25wbGFjZWhvbGRlci50eXBpY29kZS5jb20vYWxidW1zJztcblxuICAgIHN0YXRpYyByZXF1ZXN0KHVybCA9ICcnLCBtZXRob2QgPSAnR0VUJywgYm9keSkge1xuICAgICAgICByZXR1cm4gZmV0Y2goQWxidW1zLlVSTCArIHVybCwge1xuICAgICAgICAgICAgbWV0aG9kLFxuICAgICAgICAgICAgYm9keTogYm9keSA/IEpTT04uc3RyaW5naWZ5KGJvZHkpIDogdW5kZWZpbmVkLFxuICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgICdDb250ZW50LXR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICAgICB9LFxuICAgICAgICB9KVxuICAgICAgICAgICAgLmNhdGNoKChlKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGAke2UubWVzc2FnZX1gKTtcbiAgICAgICAgICAgIH0pO1xuICAgIH1cblxuICAgIHN0YXRpYyBnZXRMaXN0KCkge1xuICAgICAgICByZXR1cm4gQWxidW1zXG4gICAgICAgICAgICAucmVxdWVzdCgpXG4gICAgICAgICAgICAudGhlbihyZXMgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChyZXMub2spIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkNhbid0IGdldCB0aGUgbGlzdCBvZiBhbGJ1bXMuXCIpO1xuICAgICAgICAgICAgfSk7XG4gICAgfVxuXG59XG5cbiIsImNsYXNzIExpbmtzQ29sbGVjdGlvbiB7XG4gICAgI2xpc3RcblxuICAgIGZldGNoKCkge1xuICAgICAgICByZXR1cm4gQWxidW1zLmdldExpc3QoKS50aGVuKChsaXN0KSA9PiB7XG4gICAgICAgICAgICB0aGlzLnNldExpc3QobGlzdCk7XG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgc2V0TGlzdChsaXN0KSB7XG4gICAgICAgIHRoaXMuI2xpc3QgPSBsaXN0O1xuICAgIH1cblxuICAgIGdldExpc3QoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLiNsaXN0O1xuICAgIH1cblxuICAgIGdldEZpcnN0SWQoKXtcbiAgICAgICAgcmV0dXJuIHRoaXMuI2xpc3RbMF0uaWRcbiAgICB9XG59XG4iLCJjbGFzcyBBbGJ1bXNDb2xsZWN0aW9ue1xuICAgICNjb2xsZWN0aW9uID0gW107XG5cbiAgICBmZXRjaChpZCkge1xuICAgICAgICByZXR1cm4gQWxidW1cbiAgICAgICAgICAgIC5nZXRJbWdCeUFsYnVtSUQoaWQpXG4gICAgICAgICAgICAudGhlbigoY29sbGVjdGlvbikgPT4ge1xuICAgICAgICAgICAgdGhpcy5zZXRMaXN0KGNvbGxlY3Rpb24pO1xuICAgICAgICB9KVxuICAgIH1cblxuICAgIHNldExpc3QoY29sbGVjdGlvbikge1xuICAgICAgICB0aGlzLiNjb2xsZWN0aW9uID0gY29sbGVjdGlvbjtcbiAgICB9XG5cbiAgICBnZXRMaXN0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy4jY29sbGVjdGlvbjtcbiAgICB9XG59IiwiY2xhc3MgTGlua3NWaWV3IHtcbiAgICBzdGF0aWMgQUxCVU1TX0xJU1RfU0VMRUNUT1IgPSAnI2xpbmtzTGlzdCc7XG4gICAgc3RhdGljIEFMQlVNU19JVEVNX1NFTEVDVE9SID0gJy5saW5rc19jb250YWluZXJfX2l0ZW0nXG5cblxuICAgICMkbGlzdDtcbiAgICAjb3B0aW9ucztcblxuICAgIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcbiAgICAgICAgdGhpcy4jJGxpc3QgPSAkKExpbmtzVmlldy5BTEJVTVNfTElTVF9TRUxFQ1RPUilcbiAgICAgICAgICAgIC5vbignY2xpY2snLCBMaW5rc1ZpZXcuQUxCVU1TX0lURU1fU0VMRUNUT1IsIChlKSA9PiB0aGlzLm9uQWxidW1zTGlzdENsaWNrKGUpKVxuXG4gICAgICAgIHRoaXMuI29wdGlvbnMgPSBvcHRpb25zO1xuICAgIH1cblxuICAgIG9uQWxidW1zTGlzdENsaWNrKGUpe1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgICAgY29uc3QgaWQgPSB0aGlzLmdldEFsYnVtSWQoZS50YXJnZXQpO1xuXG4gICAgICAgIHRoaXMuI29wdGlvbnMub25TZWxlY3QoaWQpO1xuICAgIH1cblxuICAgIHJlbmRlckFsYnVtc0xpc3QobGlzdCkge1xuICAgICAgICBjb25zdCBodG1sID0gbGlzdC5tYXAobGlzdCA9PiB0aGlzLmdlbmVyYXRlSHRtbExpbmtzKGxpc3QpKS5qb2luKCcnKTtcblxuICAgICAgICB0aGlzLiMkbGlzdC5odG1sKGh0bWwpO1xuICAgIH1cblxuICAgIGFwcGVuZFRvKCRlbCkge1xuICAgICAgICAkZWwuYXBwZW5kKHRoaXMuIyRsaXN0KTtcbiAgICB9XG5cbiAgICBnZXRBbGJ1bUlkKGVsKSB7XG4gICAgICAgIHJldHVybiBlbC5jbG9zZXN0KExpbmtzVmlldy5BTEJVTVNfSVRFTV9TRUxFQ1RPUik/LmRhdGFzZXQuaWQ7XG4gICAgfVxuXG4gICAgZ2VuZXJhdGVIdG1sTGlua3MobGluayl7XG4gICAgICAgIHJldHVybiBgIFxuICAgICAgICA8bGkgY2xhc3M9XCJsaW5rc19jb250YWluZXJfX2l0ZW1cIiBkYXRhLWlkPVwiJHtsaW5rLmlkfVwiPlxuICAgICAgICAgICAgPGEgY2xhc3M9XCJsaW5rc19jb250YWluZXJfX2xpbmtcIiBocmVmPVwiaHR0cHM6Ly9qc29ucGxhY2Vob2xkZXIudHlwaWNvZGUuY29tL3Bob3Rvcz9hbGJ1bUlkPSR7bGluay51c2VySWR9XCI+JHtsaW5rLnRpdGxlfTwvYT5cbiAgICAgICAgPC9saT5cbiAgICBgO1xuICAgIH1cbn0iLCJjbGFzcyBBbGJ1bXNWaWV3e1xuICAgIHN0YXRpYyBJTUFHRVNfQ09OVEFJTkVSX1NFTEVDVE9SID0gJyNpbWdDb250YWluZXInO1xuXG4gICAgIyRnYWxsZXJ5XG5cbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy4jJGdhbGxlcnkgPSAkKEFsYnVtc1ZpZXcuSU1BR0VTX0NPTlRBSU5FUl9TRUxFQ1RPUilcbiAgICB9XG5cbiAgICBhcHBlbmRUbygkZWwpIHtcbiAgICAgICAgJGVsLmFwcGVuZCh0aGlzLiMkZ2FsbGVyeSk7XG4gICAgfVxuXG4gICAgcmVuZGVySW1nTGlzdChnYWxsZXJ5KSB7XG4gICAgICAgIHRoaXMuIyRnYWxsZXJ5LmlubmVySFRNTCA9ICcnO1xuXG4gICAgICAgIGNvbnN0IGh0bWwgPSBnYWxsZXJ5Lm1hcChnYWxsZXJ5ID0+IHRoaXMuZ2VuZXJhdGVJbWFnZXMoZ2FsbGVyeSkpLmpvaW4oJycpO1xuXG4gICAgICAgIHRoaXMuIyRnYWxsZXJ5Lmh0bWwoaHRtbClcbiAgICB9XG5cbiAgICBnZW5lcmF0ZUltYWdlcyhpbWcpe1xuICAgICAgICByZXR1cm4gYFxuICAgIDxsaSBjbGFzcz1cImltZ19jb250YWluZXJfX2l0ZW1cIj5cbiAgICAgICAgPGltZyBzcmM9XCIke2ltZy51cmx9XCIgYWx0PVwiJHtpbWcuaWR9XCI+XG4gICAgPC9saT5cbiAgICBgXG4gICAgfVxufSIsImNsYXNzIExpbmtzQ29udHJvbGxlcntcbiAgICAjJHJvb3RDb250YWluZXI7XG4gICAgI2FsYnVtc0NvbnRyb2xsZXJcblxuICAgIGNvbnN0cnVjdG9yKCRjb250YWluZXIsIGFsYnVtc0NvbnRyb2xsZXIpIHtcbiAgICAgICAgdGhpcy4jJHJvb3RDb250YWluZXIgPSAkY29udGFpbmVyO1xuICAgICAgICB0aGlzLiNhbGJ1bXNDb250cm9sbGVyID0gYWxidW1zQ29udHJvbGxlcjtcbiAgICAgICAgdGhpcy5jb2xsZWN0aW9uID0gbmV3IExpbmtzQ29sbGVjdGlvbigpO1xuICAgICAgICB0aGlzLmxpbmtzVmlldyA9IG5ldyBMaW5rc1ZpZXcoe1xuICAgICAgICAgICAgICAgIG9uU2VsZWN0OiBpZCA9PiBhbGJ1bXNDb250cm9sbGVyLmxvYWRBbGJ1bUJ5SWQoaWQpXG4gICAgICAgIH0pXG5cbiAgICAgICAgdGhpcy5saW5rc1ZpZXcuYXBwZW5kVG8odGhpcy4jJHJvb3RDb250YWluZXIpO1xuICAgICAgICB0aGlzLmNvbGxlY3Rpb24uZmV0Y2goKVxuICAgICAgICAgICAgLnRoZW4oKCkgPT4gdGhpcy5yZW5kZXJMaXN0KCkpXG4gICAgICAgICAgICAudGhlbigoKSA9PiB0aGlzLmxvYWRGaXJzdEFsYnVtKCkpXG4gICAgfVxuXG4gICAgcmVuZGVyTGlzdCgpIHtcbiAgICAgICAgdGhpcy5saW5rc1ZpZXcucmVuZGVyQWxidW1zTGlzdCh0aGlzLmNvbGxlY3Rpb24uZ2V0TGlzdCgpKTtcbiAgICB9XG5cbiAgICBsb2FkRmlyc3RBbGJ1bSgpIHtcbiAgICAgICAgY29uc3QgZmlyc3RBbGJ1bUlkID0gdGhpcy5jb2xsZWN0aW9uLmdldEZpcnN0SWQoKTtcbiAgICAgICAgdGhpcy4jYWxidW1zQ29udHJvbGxlci5sb2FkQWxidW1CeUlkKGZpcnN0QWxidW1JZClcbiAgICB9XG59XG4iLCJjbGFzcyBBbGJ1bXNDb250cm9sbGVye1xuICAgICMkcm9vdEFsYnVtQ29udGFpbmVyXG5cbiAgICBjb25zdHJ1Y3RvcihhbGJ1bUNvbnRhaW5lcikge1xuICAgICAgICB0aGlzLiMkcm9vdEFsYnVtQ29udGFpbmVyID0gYWxidW1Db250YWluZXI7XG4gICAgICAgIHRoaXMuY29sbGVjdGlvbiA9IG5ldyBBbGJ1bXNDb2xsZWN0aW9uKCk7XG4gICAgICAgIHRoaXMuYWxidW1WaWV3ID0gbmV3IEFsYnVtc1ZpZXcoKTtcblxuICAgICAgICB0aGlzLmFsYnVtVmlldy5hcHBlbmRUbyh0aGlzLiMkcm9vdEFsYnVtQ29udGFpbmVyKTtcbiAgICB9XG5cbiAgICByZW5kZXJMaXN0KCkge1xuICAgICAgICB0aGlzLmFsYnVtVmlldy5yZW5kZXJJbWdMaXN0KHRoaXMuY29sbGVjdGlvbi5nZXRMaXN0KCkpO1xuICAgIH1cblxuICAgIGxvYWRBbGJ1bUJ5SWQoaWQpe1xuICAgICAgICB0aGlzLmNvbGxlY3Rpb24uZmV0Y2goaWQpLnRoZW4oKCkgPT4gdGhpcy5yZW5kZXJMaXN0KCkpXG4gICAgfVxufVxuIl19